
# import Nielsen data
CATALOG_DONE=$(CATALOG_DIR)/.done
$(CATALOG_DONE):
	$(call _start,$(CATALOG_DIR))
	perl $(_md)/pl/import_nielsen.pl \
		$(CATALOG_INPUT_GENES) \
		$(CATALOG_INPUT_FILES) \
		$(OMIT_MGS) \
		$(CATALOG_FASTA) \
		$(CATALOG_GENE_TABLE)
	$(_end_touch)
catalog: $(CATALOG_DONE)

CAG_SELECT_DONE=$(CAG_DIR)/.done_cag_select
$(CAG_SELECT_DONE): $(CATALOG_DONE)
	$(call _start,$(CAG_DIR))
	$(_R) $(_md)/R/cag.r filter.cags \
		ifn.cag.table=$(SMALL_CAG_TABLE) \
		ifn.gene=$(CATALOG_GENE_TABLE) \
		min.prevalence=$(MIN_PREVALENCE) \
		sample.count=$(CAG_SAMPLE_COUNT) \
		ofn.cag=$(CAG_SELECTED) \
		ofn.gene=$(GENE_SELECTED)
	$(_end_touch)
cag_select: $(CAG_SELECT_DONE)

init: $(CAG_SELECT_DONE)
